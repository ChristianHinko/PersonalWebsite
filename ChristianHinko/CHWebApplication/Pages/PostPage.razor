@page "/posts/{Slug}"
@using CHWebApplication.Models
@using CHWebApplication.Services;
@inject ICHPostsService PostService

@if (Post is not null)
{
    // Render the post's component and pass in the post to it
    <DynamicComponent Type="@Post.Component" Parameters="@(new Dictionary<string, object>() { ["Post"] = Post })" />
}

@code
{
    /// <summary>
    /// The requested slug from the URL.
    /// </summary>
    [Parameter]
    public string Slug { get; set; }

    /// <summary>
    /// The post corresponding to the requested slug.
    /// </summary>
    private CHPost? Post { get; set; }

    protected override void OnParametersSet()
    {
        base.OnParametersSet();

        // Find post by slug
        Post = PostService.Posts.Find(
            post => (post.Slug == Slug)
        );
    }
}
